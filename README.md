# flexible-routing
The flexible-routing repository contains simulation code and output files to computationally assess the costs of a vehicle routing strategy with fixed routes and customer sharing. This work improves on the simulation study in the working paper by [Ledvina et al. (2020)](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3656374) and serves as supplemental files for Kirby Ledvina's masters thesis in MIT's Department of Civil and Environmental Engineering.

## Overview

We explore vehicle routing with customer sharing as a strategy to accomodate new and variable customer demands in distribution networks with fixed delivery routes. For this setting, we propose predesigning routes with some overlap such that adjacent routes share customers. This design gives the delivery fleet operator the flexibility to assign drivers to subsets of their predesigned routes in response to realized customer demands.

We define four alternative strategies for designing and executing routes with varying degrees of flexibility: dedicated routing, overlapped routing, full flexibility, and reoptimization. The Jupyter notebook *routing_examples.ipynb* describes and illustrates these  routing strategies for a randomly generated example problem. Please see [Ledvina et al. (2020)](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3656374) for a formal description of our routing model.

## Contents

This repository includes simulation code (Python), output data and figures, and an R script for creating summary figures from the data. Files include lightly edited code blocks from [Google OR-Tools](https://developers.google.com/optimization/) for the routing optimization steps (the TSP and VRP solvers).

**Code Files**
- *simulate.py* - defines new scenarios, runs the simulation, and saves the simulation's output as a single .xlsx file in the *output/* subfolder
- *supporting.py* - includes supporting code such as functions to execute routing algorithms and calculate transportation costs
- *combine_outputs.py* - combines simulation output files from the */output* subfolder into a single summary .xlsx sheet
- *create_figures.R* - reads in all files in the *output/* subfolder and generates summary graphs

Also, the Jupyter notebook *routing_examples.ipynb* is a supplemental file that allows users to generate a random customer and demand instance and see the resulting routes and costs under the different routing strategies.

**Output Files**
- *output/* - subfolder with output files generated by *simulate.py* through individual simulation runs.\*
- *combined_outputs_2020-10-23.xlsx* - the most recent compilation of simulation results. Generated by *combine_outputs.py*.
- *figures/* - subfolder with summary figures generated by *create_figures.R*

\*Note: We structured our simulation runs so that each file in *output/* covers a unique scenario.

## Running Simulations
To perform additional simulations, you will need to edit *simulate.py* to specify the scenario details as well as problem sizes and number of random instances to generate. A scenario defines several network parameters, namely primary route size, overlap size, vehicle capacity, and customer demand distribution. The code is set up to easily accomodate the following scenarios:

TODO. Insert Scenario Table.
  
For example, if you edit *simulate.py*, you will see the following line:

TODO

Comment, uncomment, and edit lines as applicable. If you wish to create a scenario other than one listed above, please refer to the section below on defining new scenarios. Save and close *simulate.py*.

**Running simulate.py**

TODO. Note that simulate.py does NOT have a command line interface, which is why we needed to directly edit the file as described in the section above.


**Defining new scenarios**
TODO

## Contributors

**Code Author:** Kirby Ledvina, MIT Data Science Lab, kirby.ledvina@gmail.com

**Collaborators**
- Hanzhang Qin, MIT Data Science Lab, hqin@mit.edu
- Prof. David Simchi-Levi (Advisor), MIT Data Science Lab, dslevi@mit.edu
- Prof. Yehua Wei, Duke Fuqua School of Business, yehua.wei@duke.edu


